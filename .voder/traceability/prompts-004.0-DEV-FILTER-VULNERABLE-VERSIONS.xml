<?xml version="1.0" encoding="UTF-8"?>
<traceability>
  <specification>prompts/004.0-DEV-FILTER-VULNERABLE-VERSIONS.md</specification>
  <status>PASSED</status>
  <last_validated>2025-11-14T08:29:51.043Z</last_validated>
  <last_modified>2025-11-09T23:02:37.596Z</last_modified>
  <evidence>• src/check-vulnerabilities.js implements npm audit–based vulnerability checks over the full dependency tree, with tests in test/check-vulnerabilities.test.js covering zero vulnerabilities, non-zero counts, WARN handling, invalid names, and cleanup.
• src/filter-by-security.js implements smart-search fallback (newest to oldest), single-version checks, severity thresholds, and appropriate include/exclude logic. It is annotated with @story prompts/004.0-DEV-FILTER-VULNERABLE-VERSIONS.md and @req tags.
• Comprehensive tests in test/filter-by-security.smart-search.test.js, test/filter-by-security.test.js, test/filter-by-security.object.test.js, test/filter-by-security-severity.test.js, and test/filter-by-security.error.table.test.js verify:  
  – Smart-search selects the next safe version and handles “no safe version”  
  – Direct and transitive checks are applied  
  – Severity thresholds respected (both numeric and object-based results)  
  – Errors are treated as safe in JSON mode and logged in table mode  
• Integration in src/apply-filters.js and src/print-outdated.js funnels mature rows through security filtering and print-outdated-handlers.js emits npm-outdated style table, JSON, and XML outputs. Table handler prints a clear “No outdated packages with safe, mature versions…” message when no safe version exists.
• Project’s existing CI (Vitest) runs 164 tests with 100% pass rate and meets coverage thresholds, ensuring this story’s functionality is exercised and green.</evidence>
  <notes>All acceptance criteria are fulfilled: mature versions are audited (direct + transitive), smart-search finds the newest safe version or indicates none, vulnerable versions are filtered out, and the final output matches npm outdated format with clear messaging. Tests reference the story and cover edge cases, confirming complete implementation.</notes>
</traceability>