<?xml version="1.0" encoding="UTF-8"?>
<traceability>
  <specification>prompts/012.0-DEV-EXIT-CODE-REFINEMENT.md</specification>
  <status>PASSED</status>
  <last_validated>2025-11-12T20:56:43.349Z</last_validated>
  <last_modified>2025-11-11T08:04:07.339Z</last_modified>
  <evidence>1. Exit code 0 (no updates):
   - test/cli.upToDate.test.js asserts exitCode===0 when dependencies are up to date.
   - test/cli.check-mode.test.js first case asserts exitCode===0 in --check JSON mode with no updates.
2. Exit code 1 (safe updates available):
   - test/cli.check-mode.test.js second and third cases assert exitCode===1 for table and JSON formats when DRY_AGED_DEPS_MOCK=1.
   - test/cli.check-mode.test.js fourth case asserts exitCode===1 for XML format.
3. Exit code 2 (errors):
   - test/cli-entrypoint.test.js asserts exitCode===2 for invalid --format flag.
   - test/cli.config-file.test.js asserts exitCode===2 for invalid config JSON, unknown keys, missing custom config.
   - test/cli.format-xml.error.test.js asserts exitCode===2 for invalid JSON in XML mode.
4. Consistency across formats:
   - CLI logic in bin/dry-aged-deps.js always uses process.exit(1) for updates, process.exit(0) for no updates, and 2 for error branches in both JSON, XML, and table flows.
   - test/cli.check-mode.test.js covers table, JSON, and XML check-mode exit codes.
5. Documentation:
   - README.md documents --check exit codes (line 59).
   - bin/dry-aged-deps.js help text (lines 213â€“226) describes --check: "exit code 1 if safe updates available, 0 if none, 2 on error".
6. Test coverage:
   - Vitest suite includes explicit tests for all exit code scenarios (93 tests across 43 files, 97% coverage).
7. Backward compatibility:
   - Existing behavior retained: help/version flags still exit 0, --format flag still supported, no breaking changes in other CLI options.
</evidence>
  <notes>The implementation fully satisfies the specification: standardized exit codes 0/1/2 are used correctly in all modes (table, JSON, XML), exit codes are documented in both README and --help, and comprehensive tests verify every scenario (no updates, updates available, and various error cases). All acceptance criteria for story 012.0-DEV-EXIT-CODE-REFINEMENT are met.</notes>
</traceability>